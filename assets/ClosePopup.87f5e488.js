import{U as a,L as oe,s as Y,d as g,j as $,X as Se,h as z,T as qe,m as ne,g as Le,K as ie,a2 as U,q as f,a3 as xe}from"./index.0c8a8fb1.js";import{e as Oe,u as He,d as Be,v as j,f as Fe,a as Me,g as _e,b as Ke,h as Ae,i as De,j as Re,c as We,k as Ve,r as Q,s as Xe,p as I,l as Ye,m as $e,n as ze,o as Ue}from"./position-engine.45a519b0.js";import{a as je,u as Qe}from"./use-dark.c0686932.js";import{c as Ie,h as Ne,b as Ge}from"./render.2c81c980.js";import{g as Je,b as Ze,a as et,h as tt}from"./scroll.d4a1c708.js";import{a as ot}from"./dom.0ccaada6.js";import{a as nt}from"./focus-manager.33224ae2.js";const v=[];let y;function it(e){y=e.keyCode===27}function st(){y===!0&&(y=!1)}function rt(e){y===!0&&(y=!1,oe(e,27)===!0&&v[v.length-1](e))}function se(e){window[e]("keydown",it),window[e]("blur",st),window[e]("keyup",rt),y=!1}function lt(e){a.is.desktop===!0&&(v.push(e),v.length===1&&se("addEventListener"))}function N(e){const t=v.indexOf(e);t>-1&&(v.splice(t,1),v.length===0&&se("removeEventListener"))}const h=[];function re(e){h[h.length-1](e)}function at(e){a.is.desktop===!0&&(h.push(e),h.length===1&&document.body.addEventListener("focusin",re))}function ut(e){const t=h.indexOf(e);t>-1&&(h.splice(t,1),h.length===0&&document.body.removeEventListener("focusin",re))}var Tt=Ie({name:"QMenu",inheritAttrs:!1,props:{...Oe,...He,...je,...Be,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:j},self:{type:String,validator:j},offset:{type:Array,validator:Fe},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Me,"click","escape-key"],setup(e,{slots:t,emit:i,attrs:n}){let s=null,l,r,E;const B=Le(),{proxy:k}=B,{$q:u}=k,c=Y(null),d=Y(!1),le=g(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),ae=Qe(e,u),{registerTick:ue,removeTick:ce}=_e(),{registerTimeout:F}=Ke(),{transition:de,transitionStyle:fe}=Ae(e,d),{localScrollTarget:M,changeScrollEvent:ve,unconfigureScrollTarget:he}=De(e,V),{anchorEl:m,canShow:me}=Re({showing:d}),{hide:_}=We({showing:d,canShow:me,handleShow:Te,handleHide:be,hideOnRouteChange:le,processOnMount:!0}),{showPortal:K,hidePortal:A,renderPortal:ge}=Ve(B,c,Ee),C={anchorEl:m,innerRef:c,onClickOutside(o){if(e.persistent!==!0&&d.value===!0)return _(o),(o.type==="touchstart"||o.target.classList.contains("q-dialog__backdrop"))&&ie(o),!0}},D=g(()=>I(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),pe=g(()=>e.cover===!0?D.value:I(e.self||"top start",u.lang.rtl)),ye=g(()=>(e.square===!0?" q-menu--square":"")+(ae.value===!0?" q-menu--dark q-dark":"")),we=g(()=>e.autoClose===!0?{onClick:Pe}:{}),R=g(()=>d.value===!0&&e.persistent!==!0);$(R,o=>{o===!0?(lt(q),Ye(C)):(N(q),Q(C))});function S(){nt(()=>{let o=c.value;o&&o.contains(document.activeElement)!==!0&&(o=o.querySelector("[autofocus], [data-autofocus]")||o,o.focus({preventScroll:!0}))})}function Te(o){if(s=e.noRefocus===!1?document.activeElement:null,at(X),K(),V(),l=void 0,o!==void 0&&(e.touchPosition||e.contextMenu)){const L=Se(o);if(L.left!==void 0){const{top:ke,left:Ce}=m.value.getBoundingClientRect();l={left:L.left-Ce,top:L.top-ke}}}r===void 0&&(r=$(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,w)),e.noFocus!==!0&&document.activeElement.blur(),ue(()=>{w(),e.noFocus!==!0&&S()}),F(()=>{u.platform.is.ios===!0&&(E=e.autoClose,c.value.click()),w(),K(!0),i("show",o)},e.transitionDuration)}function be(o){ce(),A(),W(!0),s!==null&&(o===void 0||o.qClickOutside!==!0)&&(s.focus(),s=null),F(()=>{A(!0),i("hide",o)},e.transitionDuration)}function W(o){l=void 0,r!==void 0&&(r(),r=void 0),(o===!0||d.value===!0)&&(ut(X),he(),Q(C),N(q)),o!==!0&&(s=null)}function V(){(m.value!==null||e.scrollTarget!==void 0)&&(M.value=Je(m.value,e.scrollTarget),ve(M.value,w))}function Pe(o){E!==!0?($e(k,o),i("click",o)):E=!1}function X(o){R.value===!0&&e.noFocus!==!0&&ot(c.value,o.target)!==!0&&S()}function q(o){i("escape-key"),_(o)}function w(){const o=c.value;o===null||m.value===null||Xe({el:o,offset:e.offset,anchorEl:m.value,anchorOrigin:D.value,selfOrigin:pe.value,absoluteOffset:l,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Ee(){return z(qe,{name:de.value,appear:!0},()=>d.value===!0?z("div",{role:"menu",...n,ref:c,tabindex:-1,class:["q-menu q-position-engine scroll"+ye.value,n.class],style:[n.style,fe.value],...we.value},Ne(t.default)):null)}return ne(W),Object.assign(k,{focus:S,updatePosition:w}),ge}});function bt(e,t,i){let n;function s(){n!==void 0&&(U.remove(n),n=void 0)}return ne(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){n={condition:()=>i.value===!0,handler:t},U.add(n)}}}let T=0,x,O,b,H=!1,G,J,p;function ct(e){dt(e)&&ie(e)}function dt(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=xe(e),i=e.shiftKey&&!e.deltaX,n=!i&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=i||n?e.deltaY:e.deltaX;for(let l=0;l<t.length;l++){const r=t[l];if(tt(r,n))return n?s<0&&r.scrollTop===0?!0:s>0&&r.scrollTop+r.clientHeight===r.scrollHeight:s<0&&r.scrollLeft===0?!0:s>0&&r.scrollLeft+r.clientWidth===r.scrollWidth}return!0}function Z(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function P(e){H!==!0&&(H=!0,requestAnimationFrame(()=>{H=!1;const{height:t}=e.target,{clientHeight:i,scrollTop:n}=document.scrollingElement;(b===void 0||t!==window.innerHeight)&&(b=i-t,document.scrollingElement.scrollTop=n),n>b&&(document.scrollingElement.scrollTop-=Math.ceil((n-b)/8))}))}function ee(e){const t=document.body,i=window.visualViewport!==void 0;if(e==="add"){const{overflowY:n,overflowX:s}=window.getComputedStyle(t);x=Ze(window),O=et(window),G=t.style.left,J=t.style.top,t.style.left=`-${x}px`,t.style.top=`-${O}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),n!=="hidden"&&(n==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,a.is.ios===!0&&(i===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",P,f.passiveCapture),window.visualViewport.addEventListener("scroll",P,f.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",Z,f.passiveCapture))}a.is.desktop===!0&&a.is.mac===!0&&window[`${e}EventListener`]("wheel",ct,f.notPassive),e==="remove"&&(a.is.ios===!0&&(i===!0?(window.visualViewport.removeEventListener("resize",P,f.passiveCapture),window.visualViewport.removeEventListener("scroll",P,f.passiveCapture)):window.removeEventListener("scroll",Z,f.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=G,t.style.top=J,window.scrollTo(x,O),b=void 0)}function ft(e){let t="add";if(e===!0){if(T++,p!==void 0){clearTimeout(p),p=void 0;return}if(T>1)return}else{if(T===0||(T--,T>0))return;if(t="remove",a.is.ios===!0&&a.is.nativeMobile===!0){clearTimeout(p),p=setTimeout(()=>{ee(t),p=void 0},100);return}}ee(t)}function Pt(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,ft(t))}}}function te(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var Et=Ge({name:"close-popup",beforeMount(e,{value:t}){const i={depth:te(t),handler(n){i.depth!==0&&setTimeout(()=>{const s=ze(e);s!==void 0&&Ue(s,n,i.depth)})},handlerKey(n){oe(n,13)===!0&&i.handler(n)}};e.__qclosepopup=i,e.addEventListener("click",i.handler),e.addEventListener("keyup",i.handlerKey)},updated(e,{value:t,oldValue:i}){t!==i&&(e.__qclosepopup.depth=te(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});export{Et as C,Tt as Q,Pt as a,N as b,at as c,lt as d,ut as r,bt as u};
